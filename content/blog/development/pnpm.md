---
title: 'PNPM'
date: 2021-12-31 16:21:13
category: 'development'
draft: false
---

### 빠르고, 효율적인 패키지 매니저 pnpm

#### pnpm ?

pnpm은 npm을 대체하기 위한 더 빠르고 효율적인 패키지 매니징을 선보인다. <br />

pnpm은 패키지를 설치할때 설치 패키지가 사용하는 의존성 모듈들을 직접적인 설치 방법이 아닌 심링크(하드링크)를 사용한다. <br />

즉, 설치한 패키지 중 lodash를 사용한 패키지가 100개라면 100번의 lodash설치 작업을 하는 대신 <br />

반면에 pnpm은 lodash를 단 한번만 설치하고, 다른 100개의 프로젝트에는 심링크로 연결하여, 용량 측면에서 효율적으로 패키지를 관리한다. <br />

또한 yarn이나 lerna 처럼 모노레포를 위한 기능이나, pnpmfile.js 파일을 작성해서 패키지 설치 과정에 대한 훅(Hook)도 작성할 수 있다.<br />

pnpm은 performant npm의 약자로, npm보다 낫고 yarn보다 빠른 패키지 매니저의 특징을 갖고 있다. yarn이 보다 빠르기 위해서 pnpm은 node_modules를 플랫하게 만들지 않는다.<br />

npm@~2 일 때는 굉장히 알기 쉬운 방법으로 node_modules 내부를 채웠다. 예를 들어 A->B->C로 종속 관계를 이루고 있다면, node_modules/A/.../node_modules/C 처럼 채워진다. <br />

이 경우, 종속 관계에 따라 폴더 깊이가 깊어질 수 있다. 또한 동일한 패키지가 여러번 복사될 수도 있어서, 100개의 lodash가 존재할 가능성이 있다. <br />

그래서 npm@3~부터 node_modules를 플랫하게 만든다. 아까와 같은 종속 관계가 있다면 node_modules 기준 최상위에 A,B,C 폴더를 만들고 복사한다.<br />

근데 이 작업은 간단하지 않다. 대개 하나의 프로젝트를 진행하면 적어도 하나 이상의 패키지를 설치해야 한다. 그러면 여러 패키지간의 종속 관계를 이해하고 그걸 풀어내서 플랫하게 만들어야 한다. <br />

예를 들면, 같은 lodash를 사용하더라도 semvar에 따라 각각의 패키지를 설치해야 한다. <br />

pnpm은 yarn처럼 모든 종속을 위로 올려서 플랫하게 만들지 않는다. npm@~2의 방식을 사용하되, 각 패키지(및 버전)별로 격리된 공간 내에서 플랫하게 만든 뒤, 이를 심링크로 연결한다. <br />
